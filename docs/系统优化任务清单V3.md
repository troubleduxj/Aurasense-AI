
# AuraSense AI 系统优化任务清单 V3.0

**定位升级**：从“固定功能的设备监控系统”转型为“**可配置的业务数据应用平台**”。
**核心目标**：实现“菜单自定义”、“页面可配置”、“查询更深度”。

---

## 1. 核心架构升级：动态菜单与路由系统 (Dynamic Navigation) - **[P0 关键路径]**

目前左侧菜单是写死在代码里的（`Sidebar.tsx`），无法适应灵活的业务需求。V3 的首要任务是将其“配置化”。

### 1.1 菜单元数据定义 (Menu Metadata)
*   **目标**：建立菜单的数据模型。
*   **实现**：
    *   新增 `MenuItem` 类型：
        ```typescript
        interface MenuItem {
          id: string;
          parentId?: string;      // 支持多级菜单
          label: string;          // 菜单名称 (e.g., "车间产量查询")
          icon: string;           // 图标 ID
          type: 'FOLDER' | 'PAGE' | 'LINK';
          targetId?: string;      // 关联的 Dashboard ID 或 View ID
          targetType?: 'dashboard' | 'custom_page';
          order: number;
          permissions?: string[]; // 绑定角色权限
          // [高级] 预设参数：点击菜单时自动带入的过滤条件
          defaultParams?: Record<string, any>; // e.g. { status: 'warning' }
        }
        ```

### 1.2 菜单管理功能 (Menu Configuration Page)
*   **目标**：提供一个管理界面，让管理员增删改查左侧菜单。
*   **功能**：
    *   左侧树形结构展示菜单层级。
    *   右侧表单配置菜单属性（名称、图标、关联哪个看板）。
    *   支持拖拽排序。

### 1.3 动态侧边栏与路由 (Dynamic Runtime)
*   **目标**：`Sidebar` 和 `App` 根据配置动态渲染。
*   **改造**：
    *   `App.tsx` 移除硬编码的 `activeTab` 逻辑，改为基于 `currentMenuId` 的通用渲染逻辑。
    *   **路由匹配逻辑**：
        *   如果 `menu.targetType === 'dashboard'` -> 渲染 `DashboardMonitorPage` (传入 `dashboardId`)。
        *   如果 `menu.targetType === 'custom_page'` -> 渲染系统原生页 (如数据源管理、配置页)。

---

## 2. 业务查询能力增强 (Advanced Query & Table) - **[P1 高优先级]**

目前的表格组件仅适合展示少量数据，无法满足“业务台账查询”需求。

### 2.1 超级表格组件 (Super Table)
*   **目标**：支持海量数据的查阅。
*   **功能升级**：
    *   **分页 (Pagination)**：支持前端分页（Mock环境）及后端分页接口预留。
    *   **列配置**：列宽调整、列显示/隐藏、列排序。
    *   **行操作**：在表格右侧增加“操作列”，支持自定义按钮（如“查看详情”、“导出”、“派单”）。

### 2.2 组合查询表单 (Advanced Search Form)
*   **目标**：复杂的业务查询往往需要多个条件组合。
*   **功能**：
    *   升级 `ControllerBar`，支持**多行布局**。
    *   新增控制器类型：`Text Input` (模糊搜索)、`Tree Select` (多级部门/区域选择)。

---

## 3. 交互与钻取配置 (Interaction Logic) - **[P2 中优先级]**

实现“从宏观统计到微观业务”的跳转。

### 3.1 钻取路径配置 (Drill-down Config)
*   **目标**：在图表配置页定义点击行为。
*   **配置项**：
    *   **源**：点击哪个图表 / 哪一列。
    *   **动作**：`Open_Dashboard` (打开新看板) | `Open_Modal` (弹窗详情)。
    *   **参数传递**：将当前点击的 `value` 或 `name` 作为参数传递给目标页面。

---

## 4. 实施计划 (Implementation Plan)

### 第一阶段：菜单引擎 (Menu Engine)
1.  定义 `MenuConfig` 数据结构。
2.  开发 `MenuManagerPage` (菜单管理页面)。
3.  重构 `App.tsx` 和 `Sidebar.tsx`，使其完全由数据驱动。
    *   *验证标准*：用户可以在管理页新增一个叫“测试报表”的菜单，关联到“Dashboard A”，保存后左侧菜单即时出现该项，点击可正确跳转。

### 第二阶段：表格与查询增强 (Table Power-up)
1.  升级 `ChartLab` 中的 Table 组件，增加分页和排序功能。
2.  在 `ControllerBar` 中增加文本搜索框支持。

### 第三阶段：业务闭环
1.  配置几个真实的业务场景 Demo（如：生产日报、设备故障台账）。

---

**请确认：**
如果您认可上述 V3.0 规划，我将首先着手进行 **第一阶段：菜单引擎** 的代码实现。这将彻底改变 App 的导航结构。
